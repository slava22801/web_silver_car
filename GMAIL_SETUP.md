# Инструкция по настройке Gmail для отправки писем

## Проблема: SMTPAuthenticationError

Если вы получаете ошибку `smtplib.SMTPAuthenticationError: (535, b'5.7.8 Username and Password not accepted')`, это означает, что Gmail не принимает обычный пароль. Нужно использовать **пароль приложения (App Password)**.

## Решение: Создание пароля приложения

### Шаг 1: Включите двухэтапную аутентификацию

1. Перейдите на https://myaccount.google.com/
2. В меню слева выберите **"Безопасность"**
3. Найдите раздел **"Вход в аккаунт Google"**
4. Если двухэтапная аутентификация **не включена**:
   - Нажмите **"Двухэтапная аутентификация"**
   - Следуйте инструкциям для её включения
   - Это обязательный шаг!

### Шаг 2: Создайте пароль приложения

1. На странице "Безопасность" найдите раздел **"Вход в аккаунт Google"**
2. Прокрутите вниз до раздела **"Пароли приложений"**
3. Если вы не видите этот раздел:
   - Убедитесь, что двухэтапная аутентификация включена
   - Возможно, нужно подождать несколько минут после включения
4. Нажмите **"Пароли приложений"**
5. Выберите:
   - **Приложение**: "Почта"
   - **Устройство**: "Другое устройство" (или "Windows компьютер")
   - Введите название: "Silver Car API"
6. Нажмите **"Создать"**
7. Google сгенерирует 16-значный пароль (например: `abcd efgh ijkl mnop`)
8. **Скопируйте этот пароль** (без пробелов)

### Шаг 3: Обновите код

1. Откройте файл `core/email_utils.py`
2. Найдите строку:
   ```python
   EMAIL_PASSWORD = "SilverCar!2025"
   ```
3. Замените на созданный пароль приложения:
   ```python
   EMAIL_PASSWORD = "abcdefghijklmnop"  # Ваш 16-значный пароль приложения
   ```
4. Сохраните файл

## Альтернативный способ (если пароли приложений недоступны)

Если у вас нет доступа к паролям приложений (например, корпоративный аккаунт), можно попробовать:

1. **Включить "Менее безопасные приложения"** (устаревший способ, не рекомендуется):
   - https://myaccount.google.com/lesssecureapps
   - ⚠️ Этот способ менее безопасен и может быть отключен Google

2. **Использовать OAuth2** (более сложный, но безопасный способ)

## Проверка

После настройки попробуйте создать заказ через API. Если всё настроено правильно, письмо должно отправиться успешно.

## Логи

Проверьте логи в папке `logs/` для диагностики проблем:
- Успешная отправка: `SEND_EMAIL - Order confirmation email sent successfully to ...`
- Ошибка аутентификации: `SEND_EMAIL - Authentication error for ...`

